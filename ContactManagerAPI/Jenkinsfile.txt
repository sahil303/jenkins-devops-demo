pipeline {
    agent any

    environment {
        DOTNET_ROOT = '/usr/share/dotnet'
    }

    stages {

        stage('Checkout') {
            steps {
                echo 'Checking out source code...'
                git branch: 'main', url: 'https://github.com/sahil303/jenkins-devops-demo.git'
            }
        }

        stage('Build') {
            steps {
                echo 'Building the application...'
                sh 'echo "Simulating build..."'
                // sh 'dotnet build' or 'npm install' if your app uses those
            }
        }

        stage('Test') {
            steps {
                echo 'Running tests...'
                sh 'echo "Simulating tests..."'
                // Replace with: sh 'dotnet test' or 'npm test' when needed
            }
        }

        stage('Deploy to Staging') {
            steps {
                echo "Simulating deployment to STAGING at ${env.STAGING_URL}"
                sh 'echo "Deploying build to staging server..."'
            }
        }

        stage('Approval') {
            steps {
                input message: 'Proceed to production deployment?', ok: 'Deploy'
            }
        }

        stage('Deploy to Production') {
            steps {
                echo "Simulating deployment to PRODUCTION at ${env.PRODUCTION_URL}"
                sh 'echo "Deploying build to production server..."'
            }
        }
    }

    post {
        success {
            echo 'Pipeline completed successfully.'
        }
        failure {
            echo 'Pipeline failed.'
        }
    }
}
